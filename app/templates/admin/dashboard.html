{% extends 'base.html' %}
{% block title %}Admin Dashboard{% endblock %}
{% block content %}
  <h2 class="mb-4">Admin Dashboard</h2>
  <div class="d-flex justify-content-between align-items-center mb-3">
    <a href="{{ url_for('admin.new_item') }}" class="btn btn-success">Add New Item</a>
    <div class="dropdown">
      <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
        Sort by: {% if current_sort == 'views' %}Views{% elif current_sort == 'name' %}Name{% elif current_sort == 'price' %}Price{% else %}Date Created{% endif %}
      </button>
      <ul class="dropdown-menu">
        <li><a class="dropdown-item" href="{{ url_for('admin.dashboard', sort='created_at') }}">Date Created</a></li>
        <li><a class="dropdown-item" href="{{ url_for('admin.dashboard', sort='views') }}">Most Viewed</a></li>
        <li><a class="dropdown-item" href="{{ url_for('admin.dashboard', sort='name') }}">Name</a></li>
        <li><a class="dropdown-item" href="{{ url_for('admin.dashboard', sort='price') }}">Price</a></li>
      </ul>
    </div>
  </div>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Name</th>
        <th>Price</th>
        <th>Views</th>
        <th>Sold</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for item in items %}
        <tr>
          <td>{{ item.name }}</td>
          <td>${{ '%.2f' | format(item.price) }}</td>
          <td>
            <span class="badge bg-info">{{ item.view_count or 0 }}</span>
          </td>
          <td>{{ 'Yes' if item.is_sold else 'No' }}</td>
          <td>
            <a href="{{ url_for('admin.edit_item', item_id=item.id) }}" class="btn btn-primary btn-sm">Edit</a>
            <form action="{{ url_for('admin.delete_item', item_id=item.id) }}" method="POST" style="display:inline;">
              <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Delete this item?');">Delete</button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="card mt-5" style="max-width: 300px; margin: 0 auto;">
    <div class="card-header">
      Admin Navigation
    </div>
    <ul class="nav flex-column card-body">
      <li class="nav-item mb-2">
        <a class="nav-link p-0" href="{{ url_for('admin.dashboard') }}">
          <i class="fa fa-tachometer-alt"></i> Dashboard
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link p-0" href="{{ url_for('admin.change_password') }}">
          <i class="fa fa-key"></i> Change Password
        </a>
      </li>
      <!-- Add other admin links here -->
    </ul>
  </div>
{% endblock %}
