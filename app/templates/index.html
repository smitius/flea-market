{% extends 'base.html' %}
{% block title %}{{ settings.site_name }}{% endblock %}
{% block content %}
  <div class="hero-section text-center mb-5">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <!-- Welcome Message -->
          <h1 class="display-4 mb-4 text-primary">
            <i class="fas fa-hand-wave me-2"></i>{{ settings.welcome_message }}
          </h1>
          
          <!-- General Information -->
          <div class="card mb-4 shadow-sm">
            <div class="card-body">
              <p class="card-text lead">{{ settings.general_info }}</p>
            </div>
          </div>
          
          <!-- Contact Information -->
          <div class="card bg-light">
            <div class="card-header bg-primary text-white">
              <h5 class="mb-0">
                <i class="fas fa-address-book me-2"></i>{{ _('Contact') }}
              </h5>
            </div>
            <div class="card-body">
              <div class="contact-info">
                {{ settings.contact_info | nl2br | safe }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row row-cols-1 row-cols-md-3 g-4" id="itemsGrid">
    {% for item in items %}
      <div class="col">
        <div
          class="card item-card {% if item.is_sold %}sold{% endif %}"
          data-item-id="{{ item.id }}"
          data-images="{% for img in item.images %}
    {% if img.filename in ['demo.jpg', 'noimage.jpeg'] %}
      {{ url_for('static', filename=img.filename) }}
    {% else %}
      {{ url_for('static', filename='uploads/' + img.filename) }}
    {% endif %}
    {% if not loop.last %},{% endif %}
  {% endfor %}"
          title="Click to view images"
          style="cursor: pointer;"
        >
          {% set primary_image = (item.images|selectattr('is_primary')|first) or (item.images[0] if item.images else None) %}
          {% if primary_image %}
            {% if primary_image.filename in ['demo.jpg', 'noimage.jpeg'] %}
              <img src="{{ url_for('static', filename=primary_image.filename) }}">
            {% else %}
              <img src="{{ url_for('static', filename='uploads/' + primary_image.filename) }}">
            {% endif %}
          {% else %}
            <img
              src="{{ url_for('static', filename='noimage.jpeg') }}"
              alt="No image available"
              class="card-img-top item-image"
            />
          {% endif %}
          <div class="card-body">
            <h5 class="card-title">{{ item.name }}</h5>
            <p class="card-text">{{ item.description }}</p>
            <p class="card-text"><strong>{{ _('Price') }}:</strong> <span class="price-value">{{ item.price | currency }}</span></p>
            {% if item.is_sold %}
              <span class="badge bg-danger">{{ _('Sold') }}</span>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <!-- Modern Image Gallery Modal -->
  <div class="modern-gallery" id="modernGallery">
    <div class="gallery-overlay" id="galleryOverlay"></div>
    <div class="gallery-container">
      <!-- Gallery Header -->
      <div class="gallery-header">
        <div class="gallery-title" id="galleryTitle">{{ _('More Pictures') }}</div>
        <button class="gallery-close" id="galleryClose">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <!-- Gallery Content -->
      <div class="gallery-content">
        <div class="gallery-main">
          <div class="gallery-image-container" id="galleryImageContainer">
            <img id="galleryImage" src="" alt="Item image" class="gallery-image" />
            <div class="gallery-loading" id="galleryLoading">
              <i class="fas fa-spinner fa-spin"></i>
            </div>
          </div>
          
          <!-- Navigation Arrows -->
          <button class="gallery-nav gallery-prev" id="galleryPrev">
            <i class="fas fa-chevron-left"></i>
          </button>
          <button class="gallery-nav gallery-next" id="galleryNext">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
        
        <!-- Thumbnail Strip -->
        <div class="gallery-thumbnails" id="galleryThumbnails">
          <!-- Thumbnails will be populated by JavaScript -->
        </div>
        
        <!-- Gallery Info -->
        <div class="gallery-info">
          <div class="gallery-counter" id="galleryCounter">1 / 1</div>
          <button class="gallery-fullscreen" id="galleryFullscreen">
            <i class="fas fa-expand"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
{% endblock %}